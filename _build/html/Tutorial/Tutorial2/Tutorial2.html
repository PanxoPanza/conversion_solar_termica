
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Tutorial 2 - Espectros de referencia &#8212; MEC501 - Manejo y conversión solar</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom_edits.css?v=4f657593" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Tutorial/Tutorial2/Tutorial2';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Tutorial 3 - Datos solares y climatológicos" href="../Tutorial3/Tutorial3.html" />
    <link rel="prev" title="Tutorial 1 - Modelos ópticos" href="../Tutorial1/Tutorial1.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
  
    <p class="title logo__title">MEC501 - Manejo y conversión solar</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Bienvenidos al curso
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introducción</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../00_introduccion/00_introduccion.html">Introducción al curso</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Parte 1 - Fundamentos del transporte de fotones</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../01_ondas_electromagneticas/01_ondas_electromagneticas.html">1. La radiación como un fenómeno electromagnético</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../02_ondas_EM_en_la_materia/02_ondas_EM_en_la_materia.html">2. Ondas electromagnéticas en la materia</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../03_Interacci%C3%B3n_materia-luz/03_Interacci%C3%B3n_materia-luz.html">3. Propiedades ópticas de los materiales</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../04_Scattering/04_Scattering.html">4. Scattering electromagnético</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../05_TransporteRadiativo/05_TransporteRadiativo.html">5. Transporte Radiativo</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Parte 2 - Diseño de sistemas solares</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../06_RadiacionTermica/06_RadiacionTermica.html">6. Radiación Térmica</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../07_Radiaci%C3%B3n_solar/07_Radiaci%C3%B3n_solar.html">7. Radiación Solar</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../08_ColetorSolar/08_ColetorSolar.html">8. Colectores solares estacionarios</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../09_SolarFotovoltaica/09_SolarFotovoltaica.html">9. Conversión Solar Fotovoltaica</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Parte 3 - Otras aplicaciones</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../10_CentralTermoSolar/10_CentralTermoSolar.html">10. Central Termosolar</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../11_ManejoSolarTermico_Edificio/11_ManejoSolarTermico_Edificio.html">11. Control pasivo de radiación solar en edificaciones</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Apéndice</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../Apendice/Espectro_electromagnetico/Espectro_electromagnetico.html">Espectro electromagnético</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Apendice/Teoria_del_color/Teoria_del_color.html">Teoria del color</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../Intro.html">Tutoriales</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../Tutorial1/Tutorial1.html">Tutorial 1 - Modelos ópticos</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Tutorial 2 - Espectros de referencia</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorial3/Tutorial3.html">Tutorial 3 - Datos solares y climatológicos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorial4/Tutorial4.html">Tutorial 4 - Modelación módulo PV</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/PanxoPanza/conversion_solar_termica/blob/main/Tutorial/Tutorial2/Tutorial2.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Tutorial/Tutorial2/Tutorial2.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Tutorial 2 - Espectros de referencia</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#distribucion-de-planck-bplanck">Distribución de Planck (<code class="docutils literal notranslate"><span class="pre">Bplanck</span></code>)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#irradiacion-solar-espectro-am1-5-am15">Irradiación solar, espectro AM1.5 (<code class="docutils literal notranslate"><span class="pre">AM15</span></code>)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transmitancia-atmosferica-t-atmosphere">Transmitancia atmosférica (<code class="docutils literal notranslate"><span class="pre">T_atmosphere</span></code>)</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="tutorial-2-espectros-de-referencia">
<h1>Tutorial 2 - Espectros de referencia<a class="headerlink" href="#tutorial-2-espectros-de-referencia" title="Link to this heading">#</a></h1>
<p>Este es un tutorial para utilizar el módulo <code class="docutils literal notranslate"><span class="pre">ref_spectra</span></code> de la librería <code class="docutils literal notranslate"><span class="pre">empylib</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">empylib.ref_spectra</span> <span class="k">as</span> <span class="nn">rf</span>
</pre></div>
</div>
</div>
</div>
<section id="distribucion-de-planck-bplanck">
<h2>Distribución de Planck (<code class="docutils literal notranslate"><span class="pre">Bplanck</span></code>)<a class="headerlink" href="#distribucion-de-planck-bplanck" title="Link to this heading">#</a></h2>
<p>La función <code class="docutils literal notranslate"><span class="pre">Bplanck</span></code> permite determinar la radiancia espectral de un cuerpo negro.</p>
<p>Tal como indica la documentación, los valores de entrada son:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">lam</span></code> espectro de longitudes de onda en micrones</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">T</span></code> temperatura del cuerpo negro en Kelvin</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">unit</span></code> argumento opcional en caso que se necesite el espectro de radiancia en unidades de frecuencia (<strong>no necesario para este curso</strong>)</p></li>
</ul>
<p>Como parámetro de salida, la función entregará la radiancia espectral</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -------------------------------------------------------------------</span>
<span class="c1"># librerías adicionales </span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="kn">import</span> <span class="n">ScalarFormatter</span><span class="p">,</span> <span class="n">FuncFormatter</span>
<span class="c1"># -------------------------------------------------------------------</span>

<span class="kn">import</span> <span class="nn">empylib.ref_spectra</span> <span class="k">as</span> <span class="nn">rf</span>

<span class="n">T</span> <span class="o">=</span> <span class="mi">300</span>
<span class="n">lam</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span> <span class="c1"># espectro de longitudes de onda (de 2 a 100 micrones)</span>
<span class="n">Ibb</span> <span class="o">=</span> <span class="n">rf</span><span class="o">.</span><span class="n">Bplanck</span><span class="p">(</span><span class="n">lam</span><span class="p">,</span><span class="n">T</span><span class="p">)</span>         <span class="c1"># Temperatura del cuerpo negro</span>

<span class="c1"># Graficamos resultados</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;12&#39;</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lam</span><span class="p">,</span><span class="n">Ibb</span><span class="p">,</span><span class="s1">&#39;-r&#39;</span><span class="p">)</span>    <span class="c1"># graficar absortancia</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Longitud de onda ($\mu$m)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Radiancia espectral (W/m$^2$-$\mu$m-sr)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Radiancia espectral de cuerpo negro (</span><span class="si">%i</span><span class="s1"> K)&#39;</span> <span class="o">%</span> <span class="n">T</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;&gt;:19: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:20: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:19: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:20: SyntaxWarning: invalid escape sequence &#39;\m&#39;
/tmp/ipykernel_1374/4210372336.py:19: SyntaxWarning: invalid escape sequence &#39;\m&#39;
  ax.set_xlabel(&#39;Longitud de onda ($\mu$m)&#39;)
/tmp/ipykernel_1374/4210372336.py:20: SyntaxWarning: invalid escape sequence &#39;\m&#39;
  ax.set_ylabel(&#39;Radiancia espectral (W/m$^2$-$\mu$m-sr)&#39;)
</pre></div>
</div>
<img alt="../../_images/5ecc98af33f0ea15e807905d6cf217e8a7ed4911d3660c5921bc39f817429e1b.png" src="../../_images/5ecc98af33f0ea15e807905d6cf217e8a7ed4911d3660c5921bc39f817429e1b.png" />
</div>
</div>
<p>Con esto podemos analizar la variación del poder de emisión espectral hemisférico del cuerpo negro, <span class="math notranslate nohighlight">\(\pi I_{\mathrm{bb},\lambda}\)</span>, en función de la temperatura</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">empylib.ref_spectra</span> <span class="kn">import</span> <span class="n">color_system</span> <span class="k">as</span> <span class="n">cs</span>
<span class="n">cs</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">hdtv</span>

<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;12&#39;</span>

<span class="n">lam</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>       <span class="c1"># espectro de longitudes de onda</span>
<span class="n">T_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span><span class="mi">300</span><span class="p">,</span><span class="mi">500</span><span class="p">,</span>    <span class="c1"># lista de temperaturas</span>
                   <span class="mi">1000</span><span class="p">,</span><span class="mi">2000</span><span class="p">,</span><span class="mi">4000</span><span class="p">,</span>
                   <span class="mi">5800</span><span class="p">])</span>

<span class="c1"># creamos dos listas vacías para guardar el valor máximo de cada curva y la longitud de onda asociada</span>
<span class="n">peak</span>   <span class="o">=</span> <span class="p">[]</span>            
<span class="n">lam_at</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># iteramos respecto a la temperatura</span>
<span class="k">for</span> <span class="n">T</span> <span class="ow">in</span> <span class="n">T_list</span><span class="p">:</span>
    <span class="n">Ebb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">rf</span><span class="o">.</span><span class="n">Bplanck</span><span class="p">(</span><span class="n">lam</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>                         <span class="c1"># poder de emisión hemisférico espectral del cuerpo negro</span>
    <span class="n">html_rgb</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">spec_to_rgb</span><span class="p">(</span><span class="n">Ebb</span><span class="p">,</span> <span class="n">lam</span><span class="p">,</span> <span class="n">out_fmt</span><span class="o">=</span><span class="s1">&#39;html&#39;</span><span class="p">)</span>    <span class="c1"># color asociado a la curva</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lam</span><span class="p">,</span><span class="n">Ebb</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%i</span><span class="s1"> K&#39;</span> <span class="o">%</span> <span class="n">T</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">html_rgb</span><span class="p">)</span>   <span class="c1"># graficamos el espectro usando el color anterior </span>
    <span class="n">peak</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">Ebb</span><span class="p">))</span>                               <span class="c1"># guardamos el máximo de la curva</span>
    <span class="n">lam_at</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lam</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">Ebb</span><span class="p">)])</span>                     <span class="c1"># guardamos la longitud de onda asociada al máximo</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lam_at</span><span class="p">,</span><span class="n">peak</span><span class="p">,</span><span class="s1">&#39;--k&#39;</span><span class="p">)</span> <span class="c1"># graficamos la línea correspondiente a la ley de desplazamiento de Wien</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">1E-6</span><span class="p">,</span><span class="mf">1E8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Longitud de onda, $\lambda$ ($\mu$m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$E_{\mathrm</span><span class="si">{bb}</span><span class="s1">,\lambda}$ (W/m$^2$-$\mu$m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;&gt;:29: SyntaxWarning: invalid escape sequence &#39;\l&#39;
&lt;&gt;:30: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:29: SyntaxWarning: invalid escape sequence &#39;\l&#39;
&lt;&gt;:30: SyntaxWarning: invalid escape sequence &#39;\m&#39;
/tmp/ipykernel_1374/469458870.py:29: SyntaxWarning: invalid escape sequence &#39;\l&#39;
  plt.xlabel(&#39;Longitud de onda, $\lambda$ ($\mu$m)&#39;)
/tmp/ipykernel_1374/469458870.py:30: SyntaxWarning: invalid escape sequence &#39;\m&#39;
  plt.ylabel(&#39;$E_{\mathrm{bb},\lambda}$ (W/m$^2$-$\mu$m)&#39;)
/home/panxopanza/miniconda3/lib/python3.12/site-packages/empylib/ref_spectra/ref_spectra.py:161: RuntimeWarning: overflow encountered in exp
  Ibb = 2*h*c0**2./ll**5*1/(np.exp(h*c0/(ll*T*kB)) - 1)*1E-6
</pre></div>
</div>
<img alt="../../_images/36ef7950da46ffbc2a95a5d7dedea902e6ef58ad9504fe63109ced5d440e6284.png" src="../../_images/36ef7950da46ffbc2a95a5d7dedea902e6ef58ad9504fe63109ced5d440e6284.png" />
</div>
</div>
<p>Además podemos comprobar la ley de Stefan-Boltzmann para el poder de emisión hemisférico total:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\int_\mathrm{hemi}\int_0^\infty I_{\mathrm{bb},\lambda}(\lambda,T)~\cos\theta~d\lambda~d\Omega = \pi\int_0^\infty I_{\mathrm{bb},\lambda}(\lambda,T)~d\lambda = \sigma T^4
\end{equation*}\]</div>
<p>Para la integración ocupamos la regla del trapecio a travéz de la función <code class="docutils literal notranslate"><span class="pre">numpy.trapz</span></code> (también disponible en la librería <code class="docutils literal notranslate"><span class="pre">scipy.integrate</span></code> como <code class="docutils literal notranslate"><span class="pre">trapezoid</span></code> o <code class="docutils literal notranslate"><span class="pre">trapz</span></code>). <a class="reference external" href="https://panxopanza.github.io/metodos_numericos_mec301/7-Integracion/7-Integracion.html#regla-del-trapecio-scipy-integrate-trapezoid">Más info acá</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="mi">300</span>
<span class="n">lam</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span> <span class="c1"># espectro de longitudes de onda (de 2 a 100 micrones)</span>
<span class="n">Ibb</span> <span class="o">=</span> <span class="n">rf</span><span class="o">.</span><span class="n">Bplanck</span><span class="p">(</span><span class="n">lam</span><span class="p">,</span><span class="n">T</span><span class="p">)</span>         <span class="c1"># Temperatura del cuerpo negro</span>

<span class="n">sigma</span> <span class="o">=</span> <span class="mf">5.6704E-8</span> <span class="c1"># constante de Stefan-Boltzmann</span>

<span class="n">E_int</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">Ibb</span><span class="p">,</span><span class="n">lam</span><span class="p">)</span> <span class="c1"># poder de emisión integrando la distribución de Planck</span>
<span class="n">E_sb</span> <span class="o">=</span> <span class="n">sigma</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">4</span>               <span class="c1"># poder de emisión por Steffan-Boltzmann</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Poder de emisión de cuerpo negro (integral de dist. de Planck): </span><span class="si">%.3f</span><span class="s1"> W/m^2&#39;</span> <span class="o">%</span> <span class="n">E_int</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Poder de emisión de cuerpo negro (Stefan-Boltzmann): </span><span class="si">%.3f</span><span class="s1"> W/m^2&#39;</span> <span class="o">%</span> <span class="n">E_sb</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Poder de emisión de cuerpo negro (integral de dist. de Planck): 457.136 W/m^2
Poder de emisión de cuerpo negro (Stefan-Boltzmann): 459.302 W/m^2
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p>Notar que los valores no son exáctamente iguales. Esto porque <span class="math notranslate nohighlight">\(\lambda\)</span> en la integración está acotado a <span class="math notranslate nohighlight">\(\lambda\in[2,100]\)</span> <span class="math notranslate nohighlight">\(\mu\)</span>m. El valor mejora si aumentamos el espectro de integración. Por ejemplo, para <span class="math notranslate nohighlight">\(\lambda\in[2,10000]\)</span> <span class="math notranslate nohighlight">\(\mu\)</span>m, el poder de emisión calculado a travéz de la interal es <code class="docutils literal notranslate"><span class="pre">459.300</span> <span class="pre">W/m^2</span></code>.</p>
</div></blockquote>
</section>
<section id="irradiacion-solar-espectro-am1-5-am15">
<h2>Irradiación solar, espectro AM1.5 (<code class="docutils literal notranslate"><span class="pre">AM15</span></code>)<a class="headerlink" href="#irradiacion-solar-espectro-am1-5-am15" title="Link to this heading">#</a></h2>
<p>La función <code class="docutils literal notranslate"><span class="pre">AM15</span></code> entrega el espectro global y directo del AM1.5 para un arreglo de longitudes de onda.</p>
<p>Como valor de entrada la función requiere el espectro de longitudes de onda <code class="docutils literal notranslate"><span class="pre">lam</span></code> en unidades de micrometros. La componente del espectro (horizonal global o normal directa) se puede controlar mediante un segúndo argumento <code class="docutils literal notranslate"><span class="pre">spectra_type</span></code>, con:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">spectra_type='global'</span></code>para componente horizontal global (GHI) del espectro solar. Su flujo total, integrado en el espectro de longitudes de onda, es <span class="math notranslate nohighlight">\(1000~\mathrm{W/m^2}\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">spectra_type='direct'</span></code> para componente normal directa (DNI) del espectro solar. Su flujo total, integrado en el espectro de longitudes de onda, es <span class="math notranslate nohighlight">\(900~\mathrm{W/m^2}\)</span>.</p></li>
</ul>
<p>Por defecto <code class="docutils literal notranslate"><span class="pre">spectra_type='global'</span></code></p>
<p>En el siguiente código graficaremos el espectro AM1.5 directo y global comparándolo con la radiación solar extraterrestre, <span class="math notranslate nohighlight">\(I_\mathrm{sun,out}\)</span>. Para este último, consideraremos la radiación de cuerpo negro mediante <code class="docutils literal notranslate"><span class="pre">Bplanck</span></code> escalada a partir de la constante solar.</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
I_\mathrm{sun,out} = \frac{G_\mathrm{sun}}{\sigma T^4_\mathrm{sun}} \pi I_{\mathrm{bb},\lambda}(\lambda,T_\mathrm{sun})
\end{equation*}\]</div>
<p>donde <span class="math notranslate nohighlight">\(T_\mathrm{sun} = 5777\)</span> K y <span class="math notranslate nohighlight">\(G_\mathrm{sun} = 1367\)</span> W/m<span class="math notranslate nohighlight">\(^2\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lam</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">5.0</span><span class="p">,</span><span class="mi">10000</span><span class="p">)</span>

<span class="n">sigma</span> <span class="o">=</span> <span class="mf">5.6704E-8</span> <span class="c1"># constante de Stefan-Boltzmann</span>
<span class="n">Tsun</span> <span class="o">=</span> <span class="mi">5777</span>     <span class="c1"># temperatura efectiva del sol (K)</span>
<span class="n">Gsun</span> <span class="o">=</span> <span class="mi">1367</span>      <span class="c1"># constante solar (W/m^2)</span>

<span class="n">Gsun_global</span> <span class="o">=</span> <span class="n">rf</span><span class="o">.</span><span class="n">AM15</span><span class="p">(</span><span class="n">lam</span><span class="p">,</span><span class="n">spectra_type</span><span class="o">=</span><span class="s1">&#39;global&#39;</span><span class="p">)</span>
<span class="n">Gsun_direct</span> <span class="o">=</span> <span class="n">rf</span><span class="o">.</span><span class="n">AM15</span><span class="p">(</span><span class="n">lam</span><span class="p">,</span><span class="n">spectra_type</span><span class="o">=</span><span class="s1">&#39;direct&#39;</span><span class="p">)</span>
<span class="n">Gsun_out</span>    <span class="o">=</span> <span class="n">Gsun</span><span class="o">/</span><span class="p">(</span><span class="n">sigma</span><span class="o">*</span><span class="n">Tsun</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">rf</span><span class="o">.</span><span class="n">Bplanck</span><span class="p">(</span><span class="n">lam</span><span class="p">,</span><span class="n">Tsun</span><span class="p">)</span>

<span class="c1"># Graficamos resultados</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;12&#39;</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lam</span><span class="p">,</span><span class="n">Gsun_out</span>   <span class="p">,</span><span class="s1">&#39;-r&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span><span class="s1">&#39;Extraterrestre&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lam</span><span class="p">,</span><span class="n">Gsun_global</span><span class="p">,</span><span class="s1">&#39;-b&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span><span class="s1">&#39;AM1.5 global&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lam</span><span class="p">,</span><span class="n">Gsun_direct</span><span class="p">,</span><span class="s1">&#39;-g&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span><span class="s1">&#39;AM1.5 direct&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Longitud de onda ($\mu$m)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Irradianca espectral (W/m$^2$-$\mu$m)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Irradiancia solar&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;&gt;:18: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:19: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:18: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:19: SyntaxWarning: invalid escape sequence &#39;\m&#39;
/tmp/ipykernel_1374/1578305245.py:18: SyntaxWarning: invalid escape sequence &#39;\m&#39;
  ax.set_xlabel(&#39;Longitud de onda ($\mu$m)&#39;)
/tmp/ipykernel_1374/1578305245.py:19: SyntaxWarning: invalid escape sequence &#39;\m&#39;
  ax.set_ylabel(&#39;Irradianca espectral (W/m$^2$-$\mu$m)&#39;)
</pre></div>
</div>
<img alt="../../_images/713c9808758eb010cbb315fae5597c1fb8ca0fcc2628d6e7f1bcc0f67295167e.png" src="../../_images/713c9808758eb010cbb315fae5597c1fb8ca0fcc2628d6e7f1bcc0f67295167e.png" />
</div>
</div>
<p>Comprobamos el valor integrado de cada espectro</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Flujo de energía, componente horizontal global:</span><span class="se">\t</span><span class="s1"> </span><span class="si">%.1f</span><span class="s1"> W/m2&#39;</span> <span class="o">%</span> <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">Gsun_global</span><span class="p">,</span><span class="n">lam</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Flujo de energía, componente normal directa:</span><span class="se">\t</span><span class="s1"> </span><span class="si">%.1f</span><span class="s1"> W/m2&#39;</span> <span class="o">%</span> <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">Gsun_direct</span><span class="p">,</span><span class="n">lam</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Flujo de energía, componente horizontal global:	 1000.4 W/m2
Flujo de energía, componente normal directa:	 900.1 W/m2
</pre></div>
</div>
</div>
</div>
</section>
<section id="transmitancia-atmosferica-t-atmosphere">
<h2>Transmitancia atmosférica (<code class="docutils literal notranslate"><span class="pre">T_atmosphere</span></code>)<a class="headerlink" href="#transmitancia-atmosferica-t-atmosphere" title="Link to this heading">#</a></h2>
<p>Esta función permite determinar la transmitancia atmosférica a partir de un espectro de longitudes de onda. Como valor de entrada la función requiere el espectro de longitudes de onda <code class="docutils literal notranslate"><span class="pre">lam</span></code> en unidades de micrometros.</p>
<p>En el siguiente ejemplo graficaremos la radiación de cuerpo negro con <span class="math notranslate nohighlight">\(T = 300\)</span> K, el AM1.5 global y la transmitancia atmosférica. Debido a la diferencia de escalas, <strong>utilizaremos el eje de la derecha para cuantificar la transmitancia atmosférica (<span class="math notranslate nohighlight">\(\tau_{\mathrm{atm},\lambda}\)</span>), y el eje de la izquierda para la radiación solar y de cuerpo negro</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="kn">import</span> <span class="n">ScalarFormatter</span><span class="p">,</span> <span class="n">FuncFormatter</span>

<span class="n">lam</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mf">0.3</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span><span class="mi">1000</span><span class="p">)</span> <span class="c1"># espectro de longitudes de onda</span>
<span class="n">Tbb</span> <span class="o">=</span> <span class="mi">300</span>                                           <span class="c1"># temperatura de cuerpo negro</span>

<span class="n">T_atm</span> <span class="o">=</span> <span class="n">rf</span><span class="o">.</span><span class="n">T_atmosphere</span><span class="p">(</span><span class="n">lam</span><span class="p">)</span>     <span class="c1"># Transmitancia atmosférica</span>
<span class="n">Gsun</span> <span class="o">=</span> <span class="n">rf</span><span class="o">.</span><span class="n">AM15</span><span class="p">(</span><span class="n">lam</span><span class="p">)</span>              <span class="c1"># GHI solar AM1.5</span>
<span class="n">Ebb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">rf</span><span class="o">.</span><span class="n">Bplanck</span><span class="p">(</span><span class="n">lam</span><span class="p">,</span><span class="n">Tbb</span><span class="p">)</span>  <span class="c1"># Poder de emisión espectral hemisférico de un cuerpo negro</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">ax2</span><span class="o">=</span><span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>                          <span class="c1"># segundo eje para unidades de radiación espectral</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lam</span><span class="p">,</span><span class="n">Gsun</span><span class="p">,</span><span class="s1">&#39;-y&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;AM1.5&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lam</span><span class="p">,</span><span class="n">Ebb</span><span class="o">*</span><span class="mi">10</span><span class="p">,</span><span class="s1">&#39;-r&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$E_{\mathrm</span><span class="si">{bb}</span><span class="s1">,\lambda}(</span><span class="si">%i</span><span class="s1">~\mathrm</span><span class="si">{K}</span><span class="s1">)\times 10$ &#39;</span> <span class="o">%</span> <span class="n">Tbb</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lam</span><span class="p">,</span><span class="n">T_atm</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="s1">&#39;-b&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\tau_\mathrm</span><span class="si">{atm}</span><span class="s1">$&#39;</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Longitud de onda, $\mu$m&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.75</span><span class="p">,</span><span class="mf">1.4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Irradiancia espectral (W/m$^2$-$\mu$m)&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Transmitancia (%)&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">y</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">{:.16g}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">y</span><span class="p">)))</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;&gt;:17: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:20: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:17: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:20: SyntaxWarning: invalid escape sequence &#39;\m&#39;
/tmp/ipykernel_1374/333599365.py:17: SyntaxWarning: invalid escape sequence &#39;\m&#39;
  ax1.set_xlabel(&#39;Longitud de onda, $\mu$m&#39;)
/tmp/ipykernel_1374/333599365.py:20: SyntaxWarning: invalid escape sequence &#39;\m&#39;
  ax1.set_ylabel(&#39;Irradiancia espectral (W/m$^2$-$\mu$m)&#39;)
</pre></div>
</div>
<img alt="../../_images/da3f195e6344dce90c6e9ad768e04594bfaf84e999fcc976a3db50293dea8a46.png" src="../../_images/da3f195e6344dce90c6e9ad768e04594bfaf84e999fcc976a3db50293dea8a46.png" />
</div>
</div>
<p><strong>Nota</strong> Para valores <span class="math notranslate nohighlight">\(\lambda &gt; 20\)</span> <span class="math notranslate nohighlight">\(\mu\)</span>m y <span class="math notranslate nohighlight">\(\lambda &lt; 0.8\)</span> <span class="math notranslate nohighlight">\(\mu\)</span>m, <code class="docutils literal notranslate"><span class="pre">T_atmosphere</span> <span class="pre">=</span> <span class="pre">0</span></code> automáticamente. Aunque no es consistente con la realidad, esta condicion no induce un error significativo, ya que el espectro de emisión de la atmosféra ocurre en el infrarojo medio. Esto último, considerando a la atmósfera como un cuerpo negro a temperatura <span class="math notranslate nohighlight">\(T_\mathrm{atm}\sim 0-35\)</span>°C.</p>
<p>En efecto, esto lo podemos confirmar graficando la irradiancia hemisférica espectral de la atmósfera sobre una superficie horizontal:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
G_{\mathrm{atm},\lambda} = (1 - \tau_{\mathrm{atm},\lambda})\pi I_{\mathrm{bb},\lambda}(\lambda,T_\mathrm{atm})\
\end{equation*}\]</div>
<p>donde asumimos <span class="math notranslate nohighlight">\(\rho_{\mathrm{atm},\lambda} = 0\)</span> debido a que la atmosféra esta compuesta de gases.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Tatm</span> <span class="o">=</span> <span class="mi">300</span>                                           <span class="c1"># Temperatura de la atmósfera (K)</span>
<span class="n">Eatm</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">rf</span><span class="o">.</span><span class="n">T_atmosphere</span><span class="p">(</span><span class="n">lam</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">rf</span><span class="o">.</span><span class="n">Bplanck</span><span class="p">(</span><span class="n">lam</span><span class="p">,</span><span class="n">Tatm</span><span class="p">)</span> <span class="c1"># Poder de emisión de la atmósfera (W/m^2-um)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lam</span><span class="p">,</span><span class="n">Eatm</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Longitud de onda, $\mu$m&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Irradiancia espectral hemisférica (W/m$^2$-$\mu$m)&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Irradiancia de la atmósfera a </span><span class="si">%.1f</span><span class="s1"> °C, sobre una superficie horizontal&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Tatm</span> <span class="o">-</span> <span class="mi">273</span><span class="p">))</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.75</span><span class="p">,</span><span class="mf">1.4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">y</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">{:.16g}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">y</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;&gt;:7: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:8: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:7: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:8: SyntaxWarning: invalid escape sequence &#39;\m&#39;
/tmp/ipykernel_1374/2258990544.py:7: SyntaxWarning: invalid escape sequence &#39;\m&#39;
  ax1.set_xlabel(&#39;Longitud de onda, $\mu$m&#39;)
/tmp/ipykernel_1374/2258990544.py:8: SyntaxWarning: invalid escape sequence &#39;\m&#39;
  ax1.set_ylabel(&#39;Irradiancia espectral hemisférica (W/m$^2$-$\mu$m)&#39;)
</pre></div>
</div>
<img alt="../../_images/00708fb74366da324460a408876c8d798cb1507de9b4911ece349fb99be7a5fd.png" src="../../_images/00708fb74366da324460a408876c8d798cb1507de9b4911ece349fb99be7a5fd.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Tutorial/Tutorial2"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../Tutorial1/Tutorial1.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Tutorial 1 - Modelos ópticos</p>
      </div>
    </a>
    <a class="right-next"
       href="../Tutorial3/Tutorial3.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Tutorial 3 - Datos solares y climatológicos</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#distribucion-de-planck-bplanck">Distribución de Planck (<code class="docutils literal notranslate"><span class="pre">Bplanck</span></code>)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#irradiacion-solar-espectro-am1-5-am15">Irradiación solar, espectro AM1.5 (<code class="docutils literal notranslate"><span class="pre">AM15</span></code>)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transmitancia-atmosferica-t-atmosphere">Transmitancia atmosférica (<code class="docutils literal notranslate"><span class="pre">T_atmosphere</span></code>)</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Francisco V. Ramirez-Cuevas
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>