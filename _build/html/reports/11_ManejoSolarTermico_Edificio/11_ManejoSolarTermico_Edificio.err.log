Traceback (most recent call last):
  File "/home/panxopanza/miniconda3/lib/python3.12/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/home/panxopanza/miniconda3/lib/python3.12/site-packages/nbclient/client.py", line 1305, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/panxopanza/miniconda3/lib/python3.12/site-packages/jupyter_core/utils/__init__.py", line 173, in wrapped
    return loop.run_until_complete(inner)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/panxopanza/miniconda3/lib/python3.12/asyncio/base_events.py", line 685, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/panxopanza/miniconda3/lib/python3.12/site-packages/nbclient/client.py", line 705, in async_execute
    await self.async_execute_cell(
  File "/home/panxopanza/miniconda3/lib/python3.12/site-packages/nbclient/client.py", line 1058, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/home/panxopanza/miniconda3/lib/python3.12/site-packages/nbclient/client.py", line 914, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
import empylib.nklib as nk
import empylib.waveoptics as wv
import empylib.ref_spectra as rf
import numpy as np
import matplotlib.pyplot as plt
from matplotlib.ticker import ScalarFormatter, FuncFormatter

# inicializamos √≠ndices de refracci√≥n y espectro
lam = np.linspace(0.3,3.0,1000) # espectro de longitudes de onda
n_air = 1.0                     # √≠ndice de refracci√≥n del aire
n_glass = nk.SiO2(lam)          # √≠ndice de refracci√≥n del vidrio
n_silver = nk.silver(lam)       # √≠ncide de refracci√≥n de la plata
n_mox = nk.TiO2(lam)            # √≠ncide de refracci√≥n de TiO2
d_silver = 0.008                # espesor capa de plata (um)
d_mox   = 0.030                 # espesor capa de √≥xido met√°lico (tio2 en este caso) (um)

# construimos estructura multicapas
n_layers = 3                    # tres bi-capas plata/tio2
n_lowE = [n_glass]              # vidrio en la cara frontal
d_lowE = []
for i in range(n_layers):       # for loop para agregar bi-capas
    n_lowE.append(n_silver)     # primera capa de plata
    n_lowE.append(n_mox)        # segunda capa de tio2
    
    d_lowE.append(d_silver)     # espesor de capa de plata 
    d_lowE.append(d_mox)        # espesor de capa de √≥xido met√°lico 
    
n_lowE.append(n_air)            # aire en la cara final

# Calculamos la reflectancia y transmitancia del low-E
R, T = wv.multilayer(lam,0,n_lowE,d_lowE)[:2]

# Gr√°fico de los resultados
fig, ax1 = plt.subplots(figsize=(10,3))
ax1.plot(lam,R,'-r',label = 'Reflectancia')
ax1.plot(lam,T,'-b',label = 'Transmitancia')
ax1.plot(lam,1 - R  - T,'-k',label = 'Absortancia')
ax1.legend()

# Gr√°fico de espectro solar como referencia (en un eje auxiliar)
ax2=ax1.twinx()                          # segundo eje para radiaci√≥n solar
ax2.fill_between(lam,rf.AM15(lam)/1000,color = 'y', alpha=0.2, lw = 0, label ='AM 1.5')
ax2.fill_between(lam,rf.yCIE_lum(lam),color = 'g', alpha=0.2, lw = 0, label = r'$y_\mathrm{CIE}$')

# Formato de ejes
ax1.set_xlabel('Longitud de onda, $\mu$m')
ax1.set_xscale('log')
ax1.set_xticks([0.3,0.4,0.6, 0.75, 1.4, 2, 3])
ax1.set_xlim(lam[0],lam[-1])
ax1.set_ylim(0,1)
ax2.set_ylim(bottom = 0)
ax1.set_title('Simulaci√≥n low-E coating')
ax2.set_yticks([])
ax2.legend()
ax1.xaxis.set_major_formatter(FuncFormatter(lambda y, _: '{:.16g}'.format(y)))
plt.show()
------------------

----- stderr -----
<>:46: SyntaxWarning: invalid escape sequence '\m'
<>:46: SyntaxWarning: invalid escape sequence '\m'
/tmp/ipykernel_351/1419825748.py:46: SyntaxWarning: invalid escape sequence '\m'
  ax1.set_xlabel('Longitud de onda, $\mu$m')
----- stderr -----
/tmp/ipykernel_351/1419825748.py:46: SyntaxWarning: invalid escape sequence '\m'
  ax1.set_xlabel('Longitud de onda, $\mu$m')
------------------

[0;31m---------------------------------------------------------------------------[0m
[0;31mModuleNotFoundError[0m                       Traceback (most recent call last)
Cell [0;32mIn[3], line 5[0m
[1;32m      3[0m [38;5;28;01mimport[39;00m [38;5;21;01mempylib[39;00m[38;5;21;01m.[39;00m[38;5;21;01mref_spectra[39;00m [38;5;28;01mas[39;00m [38;5;21;01mrf[39;00m
[1;32m      4[0m [38;5;28;01mimport[39;00m [38;5;21;01mnumpy[39;00m [38;5;28;01mas[39;00m [38;5;21;01mnp[39;00m
[0;32m----> 5[0m [38;5;28;01mimport[39;00m [38;5;21;01mmatplotlib[39;00m[38;5;21;01m.[39;00m[38;5;21;01mpyplot[39;00m [38;5;28;01mas[39;00m [38;5;21;01mplt[39;00m
[1;32m      6[0m [38;5;28;01mfrom[39;00m [38;5;21;01mmatplotlib[39;00m[38;5;21;01m.[39;00m[38;5;21;01mticker[39;00m [38;5;28;01mimport[39;00m ScalarFormatter, FuncFormatter
[1;32m      8[0m [38;5;66;03m# inicializamos √≠ndices de refracci√≥n y espectro[39;00m

[0;31mModuleNotFoundError[0m: No module named 'matplotlib'

